---
title: "Homework_Week_4_Part_2"
author: "Arora"
date: "September 30, 2017"
output: html_document
---

```{r}
library(curl)
f <- f <- curl("https://raw.githubusercontent.com/fuzzyatelin/fuzzyatelin.github.io/master/AN597_Fall17/zombies.csv")
d <- read.csv(f, header = TRUE, sep = ",", stringsAsFactors = FALSE)
head(d)
```
#Problem 1: Calculate the population mean and standard deviation for the following variables: height, weight, age, number of zombies killed and years of education. 

```{r}
data(d)

#Height
m<-mean(d[,5])
m
v<-var(d[,5])*(999/1000)
v
s<-sqrt(v)
s

#Weight
m<-mean(d[,6])
m
v<-var(d[,6])*(999/1000)
v
s<-sqrt(v)
s

#Age
m<-mean(d[,10])
m
v<-var(d[,10])*(999/1000)
v
s<-sqrt(v)
s

#Number of Zombies Killed
m<-mean(d[,7])
m
v<-var(d[,7])*(999/1000)
v
s<-sqrt(v)
s

#Years of Education
m<-mean(d[,8])
m
v<-var(d[,8])*(999/1000)
v
s<-sqrt(v)
s
```
#Problem 2
#ggplot boxplots of gender versus (height, weight, age, number of zombies killed, and years of education)

```{r}
#Plot for Height
library(ggplot2)
p <- ggplot(data = d, aes(x = gender, y = height))
p <- p + geom_boxplot()
p <- p + theme(axis.text.x = element_text(angle = 90))
p <- p + ylab("height")
p
```
```{r}
#Plot for Weight
p <- ggplot(data = d, aes(x = gender, y = weight))
p <- p + geom_boxplot()
p <- p + theme(axis.text.x = element_text(angle = 90))
p <- p + ylab("weight")
p
```

```{r}
#Plot for Age
p <- ggplot(data = d, aes(x = gender, y = age))
p <- p + geom_boxplot()
p <- p + theme(axis.text.x = element_text(angle = 90))
p <- p + ylab("age")
p
```

```{r}
#Plot for Number of Zombies Killed
p <- ggplot(data = d, aes(x = gender, y = zombies_killed))
p <- p + geom_boxplot()
p <- p + theme(axis.text.x = element_text(angle = 90))
p <- p + ylab("Number of Zombies Killed")
p
```

```{r}
#Plot for Years of Education
p <- ggplot(data = d, aes(x = gender, y = years_of_education))
p <- p + geom_boxplot()
p <- p + theme(axis.text.x = element_text(angle = 90))
p <- p + ylab("Years of Education")
p
```

#Problem 3
#Time to make the scatterplots of gender versus (height, weight, age, number of zombies killed, and years of education)
```{r}
#Scatterplot for Gender versus Height
p <- ggplot(data = d, aes(x = gender, y = height, 
    color = factor(gender)))  # first, we build a plot object and color points by Family
p <- p + xlab("Gender") + ylab("Height")  # then we modify the axis labels
p <- p + geom_point()  # then we make a scatterplot
p <- p + theme(legend.position = "bottom", legend.title = element_blank())  # then we modify the legend
p  # and, finally, we plot the object
```

```{r}
#Scatterplot for Gender versus Weight
p <- ggplot(data = d, aes(x = gender, y = weight, 
    color = factor(gender)))  # first, we build a plot object and color points by Family
p <- p + xlab("Gender") + ylab("Height")  # then we modify the axis labels
p <- p + geom_point()  # then we make a scatterplot
p <- p + theme(legend.position = "bottom", legend.title = element_blank())  # then we modify the legend
p  # and, finally, we plot the object
```

```{r}
#Scatterplot for Gender versus Weight
p <- ggplot(data = d, aes(x = gender, y = weight, 
    color = factor(gender)))  # first, we build a plot object and color points by Family
p <- p + xlab("Gender") + ylab("Age")  # then we modify the axis labels
p <- p + geom_point()  # then we make a scatterplot
p <- p + theme(legend.position = "bottom", legend.title = element_blank())  # then we modify the legend
p  # and, finally, we plot the object
```


#Problem 4
#Q-Q Historgrams and Looking for Normality
```{r}
qqnorm(d$height, main="Normal QQ plot for Height")
qqline(d$height, col="blue")
hist(d$height, breaks = seq(from = 50, to = 100, by = 5), probability = TRUE)

qqnorm(d$weight, main="Normal QQ plot for Height")
qqline(d$weight, col="blue")
hist(d$weight, breaks = seq(from = 80, to = 220, x=1), probability = TRUE)

qqnorm(d$age, main="Normal QQ plot for Age")
qqline(d$age, col="blue")
hist(d$age, breaks = seq(from = 0, to = 30, x = 1))

qqnorm(d$zombies_killed, main="Normal QQ plot for Number of Zombies Killed")
qqline(d$zombies_killed, col="blue")
hist(d$zombies_killed, breaks = seq(from = 0, to = 15, x = 1))
#This is a Poisson distribution

qqnorm(d$years_of_education, main="Normal QQ plot for Years of Education")
qqline(d$years_of_education, col="blue")
hist(d$years_of_education, breaks = seq(from = 0, to = 10, x = 1))
#This is also a Poisson distribution
```

#Problem 5
### Using sample() to gain a single subset of 30 zombie survivers and calculating the mean and standard deviation for each of the following varaibles (height, weight, age, years of education, number of zombies killed)

```{r}
s<-d[sample(nrow(d), 30), ]
s

m<-mean(s$height)
m
v<-var(s$height)
v
sigma<-sqrt(v)
sigma
sample_standard_error<-sqrt(sigma^2/30)
sample_standard_error
upper<-qnorm(0.95, mean=m, sd=sigma)
upper
lower<-qnorm(0.05, mean=m, sd=sigma)
lower

mean(s$weight)
m
v<-var(s$weight)
v
sigma<-sqrt(v)
sigma
sample_standard_error<-sqrt(sigma^2/30)
sample_standard_error
upper<-qnorm(0.95, mean=m, sd=sigma)
upper
lower<-qnorm(0.05, mean=m, sd=sigma)
lower

mean(s$age)
m
v<-var(s$age)
v
sigma<-sqrt(v)
sigma
sample_standard_error<-sqrt(sigma^2/30)
sample_standard_error

mean(s$zombies_killed)
v<-var(s$zombies_killed)
v
sigma<-sqrt(v)
sigma
sample_standard_error<-sqrt(sigma^2/30)
sample_standard_error
upper<-qnorm(0.95, mean=m, sd=sigma)
upper
lower<-qnorm(0.05, mean=m, sd=sigma)
lower

mean(s$years_of_education)
m
v<-var(s$years_of_education)
v
sigma<-sqrt(v)
sigma
sample_standard_error<-sqrt(sigma^2/30)
sample_standard_error
upper<-qnorm(0.95, mean=m, sd=sigma)
upper
lower<-qnorm(0.05, mean=m, sd=sigma)
lower
```
#Problem 6
#This is where 99 additional samples are drawn and the mean for each variable is calculated for each sample (that's 5 variables times 99 additional samples). The standard deviations are also calculated. Then discuss what the sampling distributions look like. 

#For problem six, could I use the code replicate? Or should I calculate the population mean and varience etc. and then draw from it 99 times and then take the mean of the means and the mean of the standard deviations from there?


#For Height
```{r}
x <- d$height
m <- mean(x)
n <- length(x)
v <- var(x)/(1000-1)
stdv <- sqrt(v)


#And then from above I would set up the variable to calculate 99 iterations?

set <- NULL  # sets up a dummy variable to hold our  simulations
n <- 15
for (i in 1:99) {
    set[i] <- mean(sample(x, n, replace = TRUE))
}

s<-d[sample(nrow(d), 30), ]
s

m<-mean(s$height)
m

#b is the mean of the all 100 samples
b<-(mean(set)+m)/2
b
#g is the addition of the two standard deviations which has to go through the combination of the variances and then the square root of the combined variance is the standard deviation of the 100 samples. I think in this case it would be a lot easier to simply take 100 samples the first time around instead of trying to combine both data sets. 
j<-(30*(stdv)+2970*sd(set))/sqrt(30+2970)
j
#j is the variance 
g<-sqrt(j)
g
```

#For Weight
```{r}
x <- d$weight
m <- mean(x)
n <- length(x)
v <- var(x)/(1000-1)
stdv <- sqrt(v)


#And then from above I would set up the variable to calculate 99 iterations?

set <- NULL  # sets up a dummy variable to hold our  simulations
n <- 15
for (i in 1:99) {
    set[i] <- mean(sample(x, n, replace = TRUE))
}

s<-d[sample(nrow(d), 30), ]
s

m<-mean(s$weight)
m

#b is the mean of the all 100 samples
b<-(mean(set)+m)/2
b
#g is the addition of the two standard deviations which has to go through the combination of the variances and then the square root of the combined variance is the standard deviation of the 100 samples. I think in this case it would be a lot easier to simply take 100 samples the first time around instead of trying to combine both data sets. 
j<-(30*(stdv)+2970*sd(set))/sqrt(30+2970)
j
#j is the variance 
g<-sqrt(j)
g
```

#For Age
```{r}
x <- d$age
m <- mean(x)
n <- length(x)
v <- var(x)/(1000-1)
stdv <- sqrt(v)


#And then from above I would set up the variable to calculate 99 iterations?

set <- NULL  # sets up a dummy variable to hold our  simulations
n <- 15
for (i in 1:99) {
    set[i] <- mean(sample(x, n, replace = TRUE))
}

s<-d[sample(nrow(d), 30), ]
s

m<-mean(s$age)
m

#b is the mean of the all 100 samples
b<-(mean(set)+m)/2
b
#g is the addition of the two standard deviations which has to go through the combination of the variances and then the square root of the combined variance is the standard deviation of the 100 samples. I think in this case it would be a lot easier to simply take 100 samples the first time around instead of trying to combine both data sets. 
j<-(30*(stdv)+2970*sd(set))/sqrt(30+2970)
j
#j is the variance 
g<-sqrt(j)
g
```

#For Number of Zombies Killed
```{r}
x <- d$zombies_killed
m <- mean(x)
n <- length(x)
v <- var(x)/(1000-1)
stdv <- sqrt(v)


#And then from above I would set up the variable to calculate 99 iterations?

set <- NULL  # sets up a dummy variable to hold our  simulations
n <- 15
for (i in 1:99) {
    set[i] <- mean(sample(x, n, replace = TRUE))
}

s<-d[sample(nrow(d), 30), ]
s

m<-mean(s$zombies_killed)
m

#b is the mean of the all 100 samples
b<-(mean(set)+m)/2
b
#g is the addition of the two standard deviations which has to go through the combination of the variances and then the square root of the combined variance is the standard deviation of the 100 samples. I think in this case it would be a lot easier to simply take 100 samples the first time around instead of trying to combine both data sets. 
j<-(30*(stdv)+2970*sd(set))/sqrt(30+2970)
j
#j is the variance 
g<-sqrt(j)
g
```

#For Years of Education
```{r}
x <- d$years_of_education
m <- mean(x)
n <- length(x)
v <- var(x)/(1000-1)
stdv <- sqrt(v)


#And then from above I would set up the variable to calculate 99 iterations?

set <- NULL  # sets up a dummy variable to hold our  simulations
n <- 15
for (i in 1:99) {
    set[i] <- mean(sample(x, n, replace = TRUE))
}

s<-d[sample(nrow(d), 30), ]
s

m<-mean(s$years_of_education)
m

#b is the mean of the all 100 samples
b<-(mean(set)+m)/2
b
#g is the addition of the two standard deviations which has to go through the combination of the variances and then the square root of the combined variance is the standard deviation of the 100 samples. I think in this case it would be a lot easier to simply take 100 samples the first time around instead of trying to combine both data sets. 
j<-(30*(stdv)+2970*sd(set))/sqrt(30+2970)
j
#j is the variance 
g<-sqrt(j)
g
```